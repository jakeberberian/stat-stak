---
title: "Scouting Reports"
output: html_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, include = TRUE, message = FALSE, warning = FALSE)
```

```{r library}
library(tidyverse)
library(lattice)
```


```{r data}
# Need to figure out data read, such that we're constantly updating with the Trackman shared 
# Possibly create a database, but access to Trackman shared needs to be constant. 
duke <- read_csv("~/stat-stak/data/duke_games_trackman.csv")
```

```{r data clean}
# Set zone 
topKzone <- 3.5
botKzone <- 1.6
inKzone <- -.95
outKzone <- 0.95

# Set pitcher and data. Need to figure out filters. Will this be R Shiny?
pitcher = "Herrick, Elijah"
date = "2020-03-04"

# Function cleans data up
clean_data <- function(df, pitcher_name, date) {
  
  df %>% 
    filter(Pitcher == pitcher_name) %>% 
    filter(Date == date) %>% 
    filter(AutoPitchType != "Undefined") %>% 
    filter(BatterSide != "Undefined")
}
```


```{r release_points}
pitchnames <- unique(clean_data(duke, pitcher, date)$AutoPitchType)

myKey <- list(space = "right",
              border = TRUE,
              cex.title = .8,
              title = "pitch type",
              text = pitchnames,
              padding.text = 4)

# Creates plot of release point with cleaned data

xyplot(RelHeight ~ RelSide, data = clean_data(duke, pitcher, date), groups = AutoPitchType,
       auto.key = myKey,
       aspect = "iso",
       xlim = c(-4.5, 4.5),
       ylim = c(0, 7.5),
       main = paste0("Release Points for ", pitcher, " on ", date), 
       xlab = "Distance from Center\nCatcher's Perspective (ft.)",
       ylab = "Height (ft.)",
       panel = function(...){
         panel.xyplot(...)
         panel.rect(inKzone, botKzone, outKzone, topKzone,
                    border="black", lty=3)
       }
)
```


```{r pitch_loc}
xyplot(PlateLocHeight ~ PlateLocSide | BatterSide, data = clean_data(duke, pitcher, date), groups = AutoPitchType,
       auto.key = myKey,
       aspect = "iso",
       xlim = c(-4.5, 4.5),
       ylim = c(0, 7.5),
       main = paste0("Pitch Locations for ", pitcher, " on ", date), 
       xlab = "Distance from Center\nCatcher's Perspective (ft.)",
       ylab = "Height (ft.)",
       panel = function(...){
         panel.xyplot(...)
         panel.rect(inKzone, botKzone, outKzone, topKzone,
                    border = "black", lty = 3)
       }
)
```





